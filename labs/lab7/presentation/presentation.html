<h1 id="вводная-часть">Вводная часть</h1>
<h2 id="цель-работы">Цель работы:</h2>
<p>Освоить на практике применение режима однократного гаммирования</p>
<h2
id="нужно-подобрать-ключ-чтобы-получить-сообщение-с-новым-годом-друзья.-требуется-разработать-приложение-позволяющее-шифровать-и-дешифровать-данные-в-режиме-однократного-гаммирования.-приложение-должно-определить-вид-шифротекста-при-известном-ключе-и-известном-открытом-тексте.-определить-ключ-с-помощью-которого-шифротекст-может-быть-преобразован-в-некоторый-фрагмент-текста-представляющий-собой-один-из-возможных-вариантов-прочтения-открытого-текста.">1.
Нужно подобрать ключ, чтобы получить сообщение «С Новым Годом, друзья!».
Требуется разработать приложение, позволяющее шифровать и дешифровать
данные в режиме однократного гаммирования. Приложение должно :
Определить вид шифротекста при известном ключе и известном открытом
тексте. Определить ключ, с помощью которого шифротекст может быть
преобразован в некоторый фрагмент текста, представляющий собой один из
возможных вариантов прочтения открытого текста.</h2>
<p>(<span class="citation" data-cites="fig-001">[рис.
@fig-001]</span>).</p>
<figure id="fig-001">
<img src="image/1.png" style="width:70.0%" alt="рис.1.1" />
<figcaption aria-hidden="true">рис.1.1</figcaption>
</figure>
<h2 id="def-hex_to_texthex_str">def hex_to_text(hex_str):</h2>
<pre><code>&quot;&quot;&quot;Convert hex string to text&quot;&quot;&quot;
bytes_obj = bytes.fromhex(hex_str)
return bytes_obj.decode(&#39;cp1251&#39;)</code></pre>
<p>def text_to_hex(text): “““Convert text to hex string”“” return
text.encode(‘cp1251’).hex().upper()</p>
<p>def xor_hex(hex1, hex2): “““XOR two hex strings”“” bytes1 =
bytes.fromhex(hex1) bytes2 = bytes.fromhex(hex2) result = bytes(a ^ b
for a, b in zip(bytes1, bytes2)) return result.hex().upper()</p>
<p>def gamma_encrypt(text, key): “““Encrypt text using gamma cipher”“”
text_hex = text_to_hex(text) key_hex = text_to_hex(key)</p>
<pre><code>if len(text_hex) != len(key_hex):
    raise ValueError(&quot;Длина текста и ключа должна совпадать&quot;)

return xor_hex(text_hex, key_hex)</code></pre>
<p>def gamma_decrypt(cipher_hex, key): “““Decrypt cipher text using
gamma cipher”“” key_hex = text_to_hex(key)</p>
<pre><code>if len(cipher_hex) != len(key_hex):
    raise ValueError(&quot;Длина шифротекста и ключа должна совпадать&quot;)

text_hex = xor_hex(cipher_hex, key_hex)
return hex_to_text(text_hex)</code></pre>
<h1 id="пример-использования">Пример использования</h1>
<p>if <strong>name</strong> == “<strong>main</strong>”:
print(“Лабораторная работа №7: Однократное гаммирование”) print(“=” *
50)</p>
<pre><code># Исходные данные из задания
center_key = &quot;050C177F0E4E37D29410092E2257FFC80BB27054&quot;
center_message = &quot;Штирлиц - Вы Герой!!&quot;
cipher_text = &quot;DDFEFF8FE5A6C1F2B930CBD502941A38E55B5175&quot;

print(&quot;1. Проверка работы алгоритма на примере из задания:&quot;)
print(f&quot;Ключ Центра: {center_key}&quot;)
print(f&quot;Сообщение Центра: {center_message}&quot;)
print(f&quot;Шифротекст у Мюллера: {cipher_text}&quot;)
print()

# Проверка шифрования
calculated_cipher = gamma_encrypt(center_message, hex_to_text(center_key))
print(f&quot;Проверка шифрования: {calculated_cipher == cipher_text}&quot;)

# Проверка дешифрования
decrypted_message = gamma_decrypt(cipher_text, hex_to_text(center_key))
print(f&quot;Проверка дешифрования: {decrypted_message == center_message}&quot;)
print()

# Подбор ключа для получения нужного сообщения
print(&quot;2. Подбор ключа для получения сообщения &#39;С Новым Годом, друзья!&#39;:&quot;)
target_message = &quot;С Новым Годом, друзья!&quot;

# Получаем hex представление целевого сообщения
target_hex = text_to_hex(target_message)
print(f&quot;Целевое сообщение в hex: {target_hex}&quot;)

# Вычисляем необходимый ключ
required_key_hex = xor_hex(cipher_text, target_hex)
required_key_text = hex_to_text(required_key_hex)

print(f&quot;Необходимый ключ в hex: {required_key_hex}&quot;)
print(f&quot;Необходимый ключ в тексте: {required_key_text}&quot;)
print()

# Проверка работы с полученным ключом
print(&quot;3. Проверка работы с полученным ключом:&quot;)
test_decryption = gamma_decrypt(cipher_text, required_key_text)
print(f&quot;Результат дешифрования: {test_decryption}&quot;)
print(f&quot;Сообщение корректно: {test_decryption == target_message}&quot;)</code></pre>
<h2 id="программа-успешно">Программа успешно:</h2>
<ol type="1">
<li><p>Проверила корректность работы алгоритма на примере из
задания</p></li>
<li><p>Подобрала ключ для преобразования шифротекста в сообщение “С
Новым Годом, друзья!”</p></li>
<li><p>Продемонстрировала работу механизма однократного
гаммирования</p></li>
</ol>
<h2 id="выводы">Выводы</h2>
<p>В ходе лабораторной работы был освоен на практике режим однократного
гаммирования. Была разработана программа, реализующая алгоритм
шифрования и дешифрования методом XOR. Однократное гаммирование
обеспечивает теоретически абсолютную стойкость при соблюдении условий.
Ключ должен быть truly случайным и использоваться только один раз Длина
ключа должна точно соответствовать длине сообщения Операция XOR является
обратимой, что делает алгоритм симметричным При известном шифротексте
можно получить любое сообщение нужной длины путем подбора
соответствующего ключа Работа продемонстрировала как преимущества
(абсолютная стойкость), так и практические limitations (проблемы с
распределением ключей) метода однократного гаммирования.</p>
